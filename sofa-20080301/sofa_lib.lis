sofa_lib.lis                                                 2007 June 3

                     ----------------------
                     SOFA Astronomy Library
                     ----------------------


PREFACE

The routines described here comprise the SOFA astronomy library.  Their
general appearance and coding style conforms to conventions agreed by
the SOFA Review Board, and their functions, names and algorithms have
been ratified by the Board.  Procedures for soliciting and agreeing
additions to the library are still evolving.

At present the routines are all written in Fortran 77, complying
with the ANSI standard (X3.9-1978) except in two respects:

  (1) All routine names are prefixed with the string "iau_".  If
      necessary, the string can be removed globally;  the result
      is correctly functioning code.

  (2) All routines include an IMPLICIT NONE statement.  This can
      be removed without affecting the behaviour of the code.

If the "iau_" string and/or the IMPLICIT NONE statements are removed
globally, the resulting code is fully ANSI-compliant and is functionally
unaffected.


GENERAL PRINCIPLES

The principal function of the SOFA Astronomy Library is to define
algorithms.  A secondary function is to provide software suitable for
convenient direct use by writers of astronomical applications.

The astronomy routines call on the SOFA vector/matrix library routines,
which are separately listed.

The routines are designed to exploit the full floating-point accuracy
of the machines on which they run, and not to rely on compiler
optimizations.  Within these constraints, the intention is that the code
corresponds to the published formulation (if any).

Dates are always Julian Dates (except in calendar conversion routines)
and are expressed as two double precision numbers which sum to the
required value.

A distinction is made between routines that implement IAU-approved
models and those that use those models to create other results.  The
former are referred to as "canonical models" in the preamble comments;
the latter are described as "support routines".

Using the library requires knowledge of positional astronomy and
time-scales.  These topics are covered in "Explanatory Supplement to the
Astronomical Almanac", P. Kenneth Seidelmann (ed.), University Science
Books, 1992.  Recent developments are documented in the journals, and
references to the relevant papers are given in the SOFA code as
required.  The IERS Conventions are also an essential reference.  The
routines concerned with Earth attitude (precession-nutation etc.) are
described in the SOFA document sofa_pn.pdf.


ROUTINES

  Calendars

     CAL2JD    Gregorian calendar to Julian Day number
     EPB       Julian Date to Besselian Epoch
     EPB2JD    Besselian Epoch to Julian Date
     EPJ       Julian Date to Julian Epoch
     EPJ2JD    Julian Epoch to Julian Date
     JD2CAL    Julian Date to Gregorian year, month, day, fraction
     JDCALF    Julian Date to Gregorian date for formatted output

  Time scales

     DAT       Delta(AT) (=TAI-UTC) for a given UTC date
     DTDB      TDB-TT

  Earth rotation angle and sidereal time

     EE00      equation of the equinoxes, IAU 2000
     EE00A     equation of the equinoxes, IAU 2000A
     EE00B     equation of the equinoxes, IAU 2000B
     EE06A     equation of the equinoxes, IAU 2006/2000A
     EECT00    equation of the equinoxes complementary terms
     EQEQ94    equation of the equinoxes, IAU 1994
     ERA00     Earth rotation angle, IAU 2000
     GMST00    Greenwich mean sidereal time, IAU 2000
     GMST06    Greenwich mean sidereal time, IAU 2006
     GMST82    Greenwich mean sidereal time, IAU 1982
     GST00A    Greenwich Apparent Sidereal Time, IAU 2000A
     GST00B    Greenwich Apparent Sidereal Time, IAU 2000B
     GST06     Greenwich apparent ST, IAU 2006, given NPB matrix
     GST06A    Greenwich apparent sidereal time, IAU 2006/2000A
     GST94     Greenwich Apparent Sidereal Time, IAU 1994

  Ephemerides (limited precision)

     EPV00     Earth position and velocity
     PLAN94    major-planet position and velocity

  Precession, nutation, polar motion

     BI00      frame bias components, IAU 2000
     BP00      frame bias and precession matrices, IAU 2000
     BP06      frame bias and precession matrices, IAU 2006
     BPN2XY    extract CIP X,Y coordinates from NPB matrix
     C2I00A    celestial-to-intermediate matrix, IAU 2000A
     C2I00B    celestial-to-intermediate matrix, IAU 2000B
     C2I06A    celestial-to-intermediate matrix, IAU 2006/2000A
     C2IBPN    celestial-to-intermediate matrix, given NPB matrix, IAU 2000
     C2IXY     celestial-to-intermediate matrix, given X,Y, IAU 2000
     C2IXYS    celestial-to-intermediate matrix, given X,Y and s
     C2T00A    celestial-to-terrestrial matrix, IAU 2000A
     C2T00B    celestial-to-terrestrial matrix, IAU 2000B
     C2T06A    celestial-to-terrestrial matrix, IAU 2006/2000A
     C2TCIO    form CIO-based celestial-to-terrestrial matrix
     C2TEQX    form equinox-based celestial-to-terrestrial matrix
     C2TPE     celestial-to-terrestrial matrix given nutation, IAU 2000
     C2TXY     celestial-to-terrestrial matrix given CIP, IAU 2000
     EO06A     equation of the origins, IAU 2006/2000A
     EORS      equation of the origins, given NPB matrix and s
     FW2M      Fukushima-Williams angles to r-matrix
     FW2XY     Fukushima-Williams angles to X,Y
     NUM00A    nutation matrix, IAU 2000A
     NUM00B    nutation matrix, IAU 2000B
     NUM06A    nutation matrix, IAU 2006/2000A
     NUMAT     form nutation matrix
     NUT00A    nutation, IAU 2000A
     NUT00B    nutation, IAU 2000B
     NUT06A    nutation, IAU 2006/2000A
     NUT80     nutation, IAU 1980
     NUTM80    nutation matrix, IAU 1980
     OBL06     mean obliquity, IAU 2006
     OBL80     mean obliquity, IAU 1980
     PB06      zeta,z,theta precession angles, IAU 2006, including bias
     PFW06     bias-precession Fukushima-Williams angles, IAU 2006
     PMAT00    precession matrix (including frame bias), IAU 2000
     PMAT06    PB matrix, IAU 2006
     PMAT76    precession matrix, IAU 1976
     PN00      bias/precession/nutation results, IAU 2000
     PN00A     bias/precession/nutation, IAU 2000A
     PN00B     bias/precession/nutation, IAU 2000B
     PN06      bias/precession/nutation results, IAU 2006
     PN06A     bias/precession/nutation results, IAU 2006/2000A
     PNM00A    classical NPB matrix, IAU 2000A
     PNM00B    classical NPB matrix, IAU 2000B
     PNM06A    classical NPB matrix, IAU 2006/2000A
     PNM80     precession/nutation matrix, IAU 1976/1980
     P06E      precession angles, IAU 2006, equinox based
     POM00     polar motion matrix
     PR00      IAU 2000 precession adjustments
     PREC76    accumulated precession angles, IAU 1976
     S00       the CIO locator s, given X,Y, IAU 2000A
     S00A      the CIO locator s, IAU 2000A
     S00B      the CIO locator s, IAU 2000B
     S06       the CIO locator s, given X,Y, IAU 2006
     S06A      the CIO locator s, IAU 2006/2000A
     SP00      the TIO locator s', IERS 2003
     XY06      CIP, IAU 2006/2000A, from series
     XYS00A    CIP and s, IAU 2000A
     XYS00B    CIP and s, IAU 2000B
     XYS06A    CIP and s, IAU 2006/2000A

  Fundamental arguments for nutation etc.

     FAD03     mean elongation of the Moon from the Sun
     FAE03     mean longitude of Earth
     FAF03     mean argument of the latitude of the Moon
     FAJU03    mean longitude of Jupiter
     FAL03     mean anomaly of the Moon
     FALP03    mean anomaly of the Sun
     FAMA03    mean longitude of Mars
     FAME03    mean longitude of Mercury
     FANE03    mean longitude of Neptune
     FAOM03    mean longitude of the Moon's ascending node
     FAPA03    general accumulated precession in longitude
     FASA03    mean longitude of Saturn
     FAUR03    mean longitude of Uranus
     FAVE03    mean longitude of Venus

  Star space motion

     PVSTAR    space motion pv-vector to star catalog data
     STARPV    star catalog data to space motion pv-vector

  Star catalog conversions

     FK52H     transform FK5 star data into the Hipparcos system
     FK5HIP    FK5 to Hipparcos rotation and spin
     FK5HZ     FK5 to Hipparcos assuming zero Hipparcos proper motion
     H2FK5     transform Hipparcos star data into the FK5 system
     HFK5Z     Hipparcos to FK5 assuming zero Hipparcos proper motion
     STARPM    proper motion between two epochs

  Obsolete

     C2TCEO    former name of C2TCIO


CALLS

   SUBROUTINE        iau_BI00   ( DPSIBI, DEPSBI, DRA )
   SUBROUTINE        iau_BP00   ( DATE1, DATE2, RB, RP, RBP )
   SUBROUTINE        iau_BP06   ( DATE1, DATE2, RB, RP, RBP )
   SUBROUTINE        iau_BPN2XY ( RBPN, X, Y )
   SUBROUTINE        iau_C2I00A ( DATE1, DATE2, RC2I )
   SUBROUTINE        iau_C2I00B ( DATE1, DATE2, RC2I )
   SUBROUTINE        iau_C2I06A ( DATE1, DATE2, RC2I )
   SUBROUTINE        iau_C2IBPN ( DATE1, DATE2, RBPN, RC2I )
   SUBROUTINE        iau_C2IXY  ( DATE1, DATE2, X, Y, RC2I )
   SUBROUTINE        iau_C2IXYS ( X, Y, S, RC2I )
   SUBROUTINE        iau_C2T00A ( TTA, TTB, UTA, UTB, XP, YP, RC2T )
   SUBROUTINE        iau_C2T00B ( TTA, TTB, UTA, UTB, XP, YP, RC2T )
   SUBROUTINE        iau_C2T06A ( TTA, TTB, UTA, UTB, XP, YP, RC2T )
   SUBROUTINE        iau_C2TCEO ( RC2I, ERA, RPOM, RC2T )
   SUBROUTINE        iau_C2TCIO ( RC2I, ERA, RPOM, RC2T )
   SUBROUTINE        iau_C2TEQX ( RBPN, GST, RPOM, RC2T )
   SUBROUTINE        iau_C2TPE  ( TTA, TTB, UTA, UTB, DPSI, DEPS,
                                  XP, YP, RC2T )
   SUBROUTINE        iau_C2TXY  ( TTA, TTB, UTA, UTB, X, Y, XP, YP,
                                  RC2T )
   SUBROUTINE        iau_CAL2JD ( IY, IM, ID, DJM0, DJM, J )
   SUBROUTINE        iau_DAT    ( IY, IM, ID, FD, DELTAT, J )
   DOUBLE PRECISION FUNCTION
                     iau_DTDB   ( DATE1, DATE2, UT, ELONG, U, V )
   DOUBLE PRECISION FUNCTION
                     iau_EE00   ( DATE1, DATE2, EPSA, DPSI )
   DOUBLE PRECISION FUNCTION
                     iau_EE00A  ( DATE1, DATE2 )
   DOUBLE PRECISION FUNCTION
                     iau_EE00B  ( DATE1, DATE2 )
   DOUBLE PRECISION FUNCTION
                     iau_EE06A  ( DATE1, DATE2 )
   DOUBLE PRECISION FUNCTION
                     iau_EECT00 ( DATE1, DATE2 )
   DOUBLE PRECISION FUNCTION
                     iau_EO06A  ( DATE1, DATE2 )
   DOUBLE PRECISION FUNCTION
                     iau_EORS   ( RNPB, S )
   DOUBLE PRECISION FUNCTION
                     iau_EPB    ( DJ1, DJ2 )
   SUBROUTINE        iau_EPB2JD ( EPB, DJM0, DJM )
   DOUBLE PRECISION FUNCTION
                     iau_EPJ    ( DJ1, DJ2 )
   SUBROUTINE        iau_EPJ2JD ( EPJ, DJM0, DJM )
   SUBROUTINE        iau_EPV00  ( DJ1, DJ2, PVH, PVB, J )
   DOUBLE PRECISION FUNCTION
                     iau_EQEQ94 ( DATE1, DATE2 )
   DOUBLE PRECISION FUNCTION
                     iau_ERA00  ( DJ1, DJ2 )
   DOUBLE PRECISION FUNCTION
                     iau_FAD03  ( T )
   DOUBLE PRECISION FUNCTION
                     iau_FAE03  ( T )
   DOUBLE PRECISION FUNCTION
                     iau_FAF03  ( T )
   DOUBLE PRECISION FUNCTION
                     iau_FAJU03 ( T )
   DOUBLE PRECISION FUNCTION
                     iau_FAL03  ( T )
   DOUBLE PRECISION FUNCTION
                     iau_FALP03 ( T )
   DOUBLE PRECISION FUNCTION
                     iau_FAMA03 ( T )
   DOUBLE PRECISION FUNCTION
                     iau_FAME03 ( T )
   DOUBLE PRECISION FUNCTION
                     iau_FANE03 ( T )
   DOUBLE PRECISION FUNCTION
                     iau_FAOM03 ( T )
   DOUBLE PRECISION FUNCTION
                     iau_FAPA03 ( T )
   DOUBLE PRECISION FUNCTION
                     iau_FASA03 ( T )
   DOUBLE PRECISION FUNCTION
                     iau_FAUR03 ( T )
   DOUBLE PRECISION FUNCTION
                     iau_FAVE03 ( T )
   SUBROUTINE        iau_FK52H  ( R5, D5, DR5, DD5, PX5, RV5,
                                  RH, DH, DRH, DDH, PXH, RVH )
   SUBROUTINE        iau_FK5HIP ( R5H, S5H )
   SUBROUTINE        iau_FK5HZ  ( R5, D5, DATE1, DATE2, RH, DH)
   SUBROUTINE        iau_FW2M   ( GAMB, PHIB, PSI, EPS, R )
   SUBROUTINE        iau_FW2XY  ( GAMB, PHIB, PSI, EPS, X, Y )
   DOUBLE PRECISION FUNCTION
                     iau_GMST00 ( UTA, UTB, TTA, TTB )
   DOUBLE PRECISION FUNCTION
                     iau_GMST06 ( UTA, UTB, TTA, TTB )
   DOUBLE PRECISION FUNCTION
                     iau_GMST82 ( UTA, UTB )
   DOUBLE PRECISION FUNCTION
                     iau_GST00A ( UTA, UTB, TTA, TTB )
   DOUBLE PRECISION FUNCTION
                     iau_GST00B ( UTA, UTB )
   DOUBLE PRECISION FUNCTION
                     iau_GST06  ( UTA, UTB, TTA, TTB, RNPB )
   DOUBLE PRECISION FUNCTION
                     iau_GST06A ( UTA, UTB, TTA, TTB )
   DOUBLE PRECISION FUNCTION
                     iau_GST94  ( UTA, UTB )
   SUBROUTINE        iau_H2FK5  ( RH, DH, DRH, DDH, PXH, RVH,
                                  R5, D5, DR5, DD5, PX5, RV5 )
   SUBROUTINE        iau_HFK5Z  ( RH, DH, DATE1, DATE2,
                                  R5, D5, DR5, DD5 )
   SUBROUTINE        iau_JD2CAL ( DJ1, DJ2, IY, IM, ID, FD, J )
   SUBROUTINE        iau_JDCALF ( NDP, DJ1, DJ2, IYMDF, J )
   SUBROUTINE        iau_NUM00A ( DATE1, DATE2, RMATN )
   SUBROUTINE        iau_NUM00B ( DATE1, DATE2, RMATN )
   SUBROUTINE        iau_NUM06A ( DATE1, DATE2, RMATN )
   SUBROUTINE        iau_NUMAT  ( EPSA, DPSI, DEPS, RMATN )
   SUBROUTINE        iau_NUT00A ( DATE1, DATE2, DPSI, DEPS )
   SUBROUTINE        iau_NUT00B ( DATE1, DATE2, DPSI, DEPS )
   SUBROUTINE        iau_NUT06A ( DATE1, DATE2, DPSI, DEPS )
   SUBROUTINE        iau_NUT80  ( DATE1, DATE2, DPSI, DEPS )
   SUBROUTINE        iau_NUTM80 ( DATE1, DATE2, RMATN )
   DOUBLE PRECISION FUNCTION
                     iau_OBL06  ( DATE1, DATE2 )
   DOUBLE PRECISION FUNCTION
                     iau_OBL80  ( DATE1, DATE2 )
   SUBROUTINE        iau_PB06   ( DATE1, DATE2, BZETA, BZ, BTHETA )
   SUBROUTINE        iau_PFW06  ( DATE1, DATE2, GAMB, PHIB, PSIB, EPSA )
   SUBROUTINE        iau_PLAN94 ( DATE1, DATE2, NP, PV, J )
   SUBROUTINE        iau_PMAT00 ( DATE1, DATE2, RBP )
   SUBROUTINE        iau_PMAT06 ( DATE1, DATE2, RBP )
   SUBROUTINE        iau_PMAT76 ( DJ1, DJ2, RMATP )
   SUBROUTINE        iau_PN00   ( DATE1, DATE2, DPSI, DEPS,
                                  EPSA, RB, RP, RBP, RN, RBPN )
   SUBROUTINE        iau_PN00A  ( DATE1, DATE2, DPSI, DEPS, EPSA,
                                  RB, RP, RBP, RN, RBPN )
   SUBROUTINE        iau_PN00B  ( DATE1, DATE2, DPSI, DEPS, EPSA,
                                  RB, RP, RBP, RN, RBPN )
   SUBROUTINE        iau_PN06   ( DATE1, DATE2, DPSI, DEPS,
                                  EPSA, RB, RP, RBP, RN, RBPN )
   SUBROUTINE        iau_PN06A  ( DATE1, DATE2,
                                  RB, RP, RBP, RN, RBPN )
   SUBROUTINE        iau_PNM00A ( DATE1, DATE2, RBPN )
   SUBROUTINE        iau_PNM00B ( DATE1, DATE2, RBPN )
   SUBROUTINE        iau_PNM06A ( DATE1, DATE2, RNPB )
   SUBROUTINE        iau_PNM80  ( DATE1, DATE2, RMATPN )
   SUBROUTINE        iau_P06E   ( DATE1, DATE2,
                                  EPS0, PSIA, OMA, BPA, BQA, PIA, BPIA,
                                  EPSA, CHIA, ZA, ZETAA, THETAA, PA,
                                  GAM, PHI, PSI )
   SUBROUTINE        iau_POM00  ( XP, YP, SP, RPOM )
   SUBROUTINE        iau_PR00   ( DATE1, DATE2, DPSIPR, DEPSPR )
   SUBROUTINE        iau_PREC76 ( EP01, EP02, EP11, EP12,
                                  ZETA, Z, THETA )
   SUBROUTINE        iau_PVSTAR ( PV, RA, DEC, PMR, PMD, PX, RV, J )
   DOUBLE PRECISION FUNCTION
                     iau_S00    ( DATE1, DATE2, X, Y )
   DOUBLE PRECISION FUNCTION
                     iau_S00A   ( DATE1, DATE2 )
   DOUBLE PRECISION FUNCTION
                     iau_S00B   ( DATE1, DATE2 )
   DOUBLE PRECISION FUNCTION
                     iau_S06    ( DATE1, DATE2, X, Y )
   DOUBLE PRECISION FUNCTION
                     iau_S06A   ( DATE1, DATE2 )
   DOUBLE PRECISION FUNCTION
                     iau_SP00   ( DATE1, DATE2 )
   SUBROUTINE        iau_STARPM ( RA1, DEC1, PMR1, PMD1, PX1, RV1,
                                  EP1A, EP1B, EP2A, EP2B,
                                  RA2, DEC2, PMR2, PMD2, PX2, RV2, J )
   SUBROUTINE        iau_STARPV ( RA, DEC, PMR, PMD, PX, RV, PV, J )
   SUBROUTINE        iau_XYS06  ( DATE1, DATE2, X, Y )
   SUBROUTINE        iau_XYS00A ( DATE1, DATE2, X, Y, S )
   SUBROUTINE        iau_XYS00B ( DATE1, DATE2, X, Y, S )
   SUBROUTINE        iau_XYS06A ( DATE1, DATE2, X, Y, S )
